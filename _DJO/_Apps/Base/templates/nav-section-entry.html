{# Django template: nav-section-entry.html #}
{% comment %}
  ## Copyright (C) 2008-2010 Mag. Christian Tanzer. All rights reserved
  ## Glasauergasse 32, A--1130 Wien, Austria. tanzer@swing.co.at
  ##
  ##
  ##++
  ## Name
  ##    nav-section-entry
  ##
  ## Purpose
  ##    Template for one entry of a nav-section
  ##
  ## Revision Dates
  ##    29-Feb-2008 (CT) Creation (factored from nav-section-level.html)
  ##    29-Feb-2008 (CT) Changed to recursively `rrender
  ##                     "nav-section-level.html"` for sub-sections
  ##    13-Apr-2008 (CT) Check `ifequal link.href page.link.href` instead of
  ##                     `ifequal link page.link` to determine `current-link`
  ##    21-May-2008 (CT) s/page.link/page/w
  ##    23-May-2008 (CT) `if link.href` moved from outermost to innermost
  ##    26-Sep-2008 (CT) Use `nav_page` instead of `page` to access `href`
  ##                     and `prefix`
  ##     3-Oct-2008 (CT) Use `link.has_children` instead of `link.own_links`
  ##                     for predicate about `current-section`
  ##    17-Oct-2008 (CT) `login_required` added
  ##    17-Oct-2008 (CT) Wrap `current-section` inside a `a`
  ##    17-Oct-2008 (CT) Use `allow_user`  instead of `login_required`
  ##     9-Dec-2010 (CT) Support for `a_img` added
  ##    ««revision-date»»···
  ##--
{% endcomment %}
{% load TGL %}
{% if NAV.permissive or link|allow_user:request.user %}
  {% let %}
    {% blet level %}level-{{ link.level|default:0 }}{% endblet %}
    {% if nav_page.prefix|starts_with:link.prefix and link.has_children %}
      <li class="current-section {{ level }}">
        <a href="{{ link.site_prefix }}{{ link.href }}"
               {% if link.desc %}title="{{ link.desc }}"{% endif %}
               class="current-section"
            >{{ link.title }}</a>
        {% rrender "nav-section-level.html" link_list=link.own_links %}
      </li>
    {% else %}
      {% ifequal link.href nav_page.href %}
        <li class="current-link {{ level }}">{{ link.title }}</li>
      {% else %}
        {% if link.href %}
          <li class="nav-link {{ level }}">
            <a href="{{ link.site_prefix }}{{ link.href }}"
               {% if link.desc %}title="{{ link.desc }}"{% endif %}
            >
              {% if link.a_img %}
                <img alt="{{ link.title }}" src="{{ link.a_img }}" />
              {% else %}
                {{ link.title }}
              {% endif %}
            </a>
          </li>
        {% else %}
          <li class="no-link">{{ link.title|safe }}</li>
        {% endif %}
      {% endifequal %}
    {% endif %}
  {% endlet %}
{% else %}
  <li>{{ link.title|safe }}</li>
{% endif %}
{# __END__ Django template: nav-section-entry.html #}
